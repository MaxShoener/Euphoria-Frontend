<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Euphoria</title>
<style>
  body { font-family: sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; }
  #controls { padding: 10px; background: #222; color: white; display: flex; gap: 5px; }
  input[type=text] { flex: 1; padding: 5px; font-size: 16px; }
  button { padding: 5px 10px; font-size: 16px; }
  #output { flex: 1; background: #000; display: flex; align-items: center; justify-content: center; }
  #browserFrame { max-width: 100%; max-height: 100%; }
</style>
</head>
<body>
<div id="controls">
  <button id="back">◀</button>
  <button id="forward">▶</button>
  <input id="url" type="text" placeholder="Enter URL or search..." />
  <button id="go">Go</button>
</div>
<div id="output">
  <img id="browserFrame" src="" alt="Browser output" />
</div>

<script>
let ws;
const img = document.getElementById('browserFrame');
const urlInput = document.getElementById('url');
const goBtn = document.getElementById('go');
const backBtn = document.getElementById('back');
const forwardBtn = document.getElementById('forward');

// Replace with your backend WebSocket
const backendURL = "wss://wisp-server-w7nx.onrender.com"; 

function connect() {
    ws = new WebSocket(backendURL);
    ws.onopen = () => console.log("Connected to backend");
    ws.onmessage = (msg) => {
        if(msg.data instanceof Blob) {
            const url = URL.createObjectURL(msg.data);
            img.src = url;
        } else {
            console.log("Backend message:", msg.data);
        }
    };
    ws.onclose = () => setTimeout(connect, 3000);
}
connect();

function sendCommand(command, value) {
    if(ws.readyState === WebSocket.OPEN) {
        ws.send(JSON.stringify({ command, value }));
    }
}

goBtn.onclick = () => {
    const val = urlInput.value.trim();
    if(val.startsWith("http")) sendCommand("navigate", val);
    else sendCommand("search", val);
};
urlInput.onkeypress = (e) => { if(e.key === "Enter") goBtn.click(); };
backBtn.onclick = () => sendCommand("back");
forwardBtn.onclick = () => sendCommand("forward");
</script>
</body>
</html>