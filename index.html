<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Euphoria</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; height: 100vh; display: flex; flex-direction: column; }
    
    header {
      background-color: #2c3e50;
      color: white;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .tabs {
      display: flex;
      gap: 4px;
      flex: 1;
    }

    .tab {
      background-color: #34495e;
      padding: 5px 10px;
      border-radius: 4px 4px 0 0;
      cursor: pointer;
      user-select: none;
    }

    .tab.active {
      background-color: #1abc9c;
      font-weight: bold;
    }

    .address-bar {
      display: flex;
      gap: 4px;
      flex: 2;
    }

    input[type="text"] {
      flex: 1;
      padding: 5px;
      border-radius: 4px;
      border: none;
      font-size: 16px;
    }

    button {
      padding: 5px 12px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background-color: #1abc9c;
      color: white;
    }

    iframe {
      flex: 1;
      width: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <header>
    <div class="tabs" id="tabsContainer">
      <div class="tab active" data-id="tab1">Tab 1</div>
    </div>
    <div class="address-bar">
      <input id="urlInput" type="text" placeholder="Type URL or search...">
      <button id="goBtn">Enter</button>
    </div>
  </header>

  <iframe id="browserFrame" src=""></iframe>

  <script>
    const tabsContainer = document.getElementById('tabsContainer');
    const urlInput = document.getElementById('urlInput');
    const goBtn = document.getElementById('goBtn');
    const iframe = document.getElementById('browserFrame');

    const sessions = { tab1: 'user1' };
    let activeTab = 'tab1';

    function loadURL() {
      const query = urlInput.value.trim();
      if (!query) return;

      // Automatically treat non-URLs as Google search
      let url = query.startsWith('http') ? query : query;
      iframe.src = `https://wisp-server-w7nx.onrender.com/browse?url=${encodeURIComponent(url)}&session=${sessions[activeTab]}`;
    }

    goBtn.addEventListener('click', loadURL);
    urlInput.addEventListener('keydown', e => { if (e.key === 'Enter') loadURL(); });

    // Tab switching
    tabsContainer.addEventListener('click', e => {
      if (e.target.classList.contains('tab')) {
        document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        e.target.classList.add('active');
        activeTab = e.target.dataset.id;
        urlInput.value = ''; // reset input for new tab
        iframe.src = ''; // clear iframe
      }
    });

    // Example: add a new tab functionality
    function addTab() {
      const newId = `tab${Object.keys(sessions).length + 1}`;
      const tabDiv = document.createElement('div');
      tabDiv.className = 'tab';
      tabDiv.dataset.id = newId;
      tabDiv.textContent = `Tab ${Object.keys(sessions).length + 1}`;
      tabsContainer.appendChild(tabDiv);
      sessions[newId] = `user${Object.keys(sessions).length + 1}`;
    }

    // For demonstration, add a second tab after 1s
    setTimeout(addTab, 1000);
  </script>
</body>
</html>
