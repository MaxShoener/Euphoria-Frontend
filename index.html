<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Euphoria Proxy</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f4f4f4;
  }

  header {
    display: flex;
    align-items: center;
    padding: 10px;
    background: #1f2937;
    color: #fff;
  }

  header input[type="text"] {
    flex: 1;
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    font-size: 16px;
    margin-right: 10px;
  }

  header button {
    padding: 8px 12px;
    border: none;
    border-radius: 6px;
    background: #3b82f6;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.2s;
  }

  header button:hover {
    background: #2563eb;
  }

  iframe {
    width: 100%;
    height: calc(100vh - 60px);
    border: none;
  }
</style>
</head>
<body>

<header>
  <input id="urlInput" type="text" placeholder="Enter URL or search query..." />
  <button id="goBtn">Enter</button>
</header>

<iframe id="proxyFrame" src=""></iframe>

<script>
const goBtn = document.getElementById('goBtn');
const urlInput = document.getElementById('urlInput');
const iframe = document.getElementById('proxyFrame');

function navigate() {
  let input = urlInput.value.trim();
  if (!input) return;

  // Detect if input is a URL
  if (!input.startsWith('http://') && !input.startsWith('https://')) {
    // Treat as search query
    input = 'https://www.google.com/search?q=' + encodeURIComponent(input);
  }

  // Proxy backend endpoint
  const backendURL = 'https://wisp-server-w7nx.onrender.com/browse'; // your backend

  fetch(backendURL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ url: input })
  })
  .then(res => res.json())
  .then(data => {
    if (data.html) {
      // Render fetched HTML inside iframe using a Blob
      const blob = new Blob([data.html], { type: 'text/html' });
      iframe.src = URL.createObjectURL(blob);
    } else {
      alert('Failed to load page');
    }
  })
  .catch(err => {
    console.error(err);
    alert('Error fetching page');
  });
}

goBtn.addEventListener('click', navigate);
urlInput.addEventListener('keydown', e => {
  if (e.key === 'Enter') navigate();
});
</script>

</body>
</html>
