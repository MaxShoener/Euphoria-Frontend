<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Euphoria</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; background: #121212; color: #fff; }
    header { display: flex; align-items: center; padding: 10px; background: #1e1e1e; }
    input { flex: 1; padding: 8px; border: none; border-radius: 4px; margin: 0 10px; }
    button { padding: 8px 12px; margin-right: 5px; background: #3a3a3a; border: none; border-radius: 4px; color: #fff; cursor: pointer; }
    button:hover { background: #555; }
    iframe { width: 100%; height: calc(100vh - 50px); border: none; background: #fff; }
  </style>
</head>
<body>
  <header>
    <button id="back">⬅️</button>
    <button id="forward">➡️</button>
    <input type="text" id="url" placeholder="Enter URL or search...">
    <button id="go">Go</button>
  </header>
  <iframe id="viewer"></iframe>

  <script>
    const backend = "https://wisp-server-w7nx.onrender.com"; // ✅ your backend

    const iframe = document.getElementById("viewer");
    const input = document.getElementById("url");
    const goBtn = document.getElementById("go");
    const backBtn = document.getElementById("back");
    const forwardBtn = document.getElementById("forward");

    let historyStack = [], historyIndex = -1;

    function formatUrl(query) {
      if (query.startsWith("http://") || query.startsWith("https://")) return query;
      if (query.includes(".")) return "https://" + query;
      return "https://www.google.com/search?q=" + encodeURIComponent(query);
    }

    function navigate(query) {
      const target = formatUrl(query);
      iframe.src = backend + "/browse?url=" + encodeURIComponent(target);
      if (historyIndex < historyStack.length - 1) historyStack = historyStack.slice(0, historyIndex + 1);
      historyStack.push(query);
      historyIndex++;
    }

    goBtn.onclick = () => navigate(input.value);
    input.addEventListener("keypress", e => { if (e.key === "Enter") navigate(input.value); });
    backBtn.onclick = () => { if (historyIndex > 0) { historyIndex--; input.value = historyStack[historyIndex]; navigate(input.value); } };
    forwardBtn.onclick = () => { if (historyIndex < historyStack.length - 1) { historyIndex++; input.value = historyStack[historyIndex]; navigate(input.value); } };
  </script>
</body>
</html>