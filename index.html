<!-- ... your existing UI head and styles ... -->

<header>
  <button id="back">‚óÄ</button>
  <button id="forward">‚ñ∂</button>
  <button id="reload">‚ü≥</button>
  <button id="home">üè†</button>
  <input type="text" id="url" placeholder="Search or type URL..." />
  <select id="engine">
    <option value="scramjet">Scramjet</option>
    <option value="uv">Ultraviolet</option>
  </select>
  <button id="go">Go</button>
  <button id="fullscreen">‚õ∂</button>
</header>

<!-- ... your existing iframe ... -->

<script>
const iframe = document.getElementById("browser");
const urlInput = document.getElementById("url");
const backBtn = document.getElementById("back");
const forwardBtn = document.getElementById("forward");
const reloadBtn = document.getElementById("reload");
const homeBtn = document.getElementById("home");
const goBtn = document.getElementById("go");
const fullscreenBtn = document.getElementById("fullscreen");
const engineSelect = document.getElementById("engine");

const backendURL = "/proxy";
const homePage = "https://www.google.com";

const historyStack = [];
let currentIndex = -1;
let isFullscreen = false;

function encodeURL(url) {
  if (!/^https?:\/\//i.test(url)) {
    return encodeURIComponent("https://www.google.com/search?q=" + encodeURIComponent(url));
  }
  return encodeURIComponent(url);
}

function loadURL(url) {
  const encoded = encodeURL(url);
  const engine = engineSelect.value;
  iframe.src = `${backendURL}?url=${encoded}&engine=${engine}`;

  if (currentIndex < historyStack.length - 1) {
    historyStack.splice(currentIndex + 1);
  }
  historyStack.push(url);
  currentIndex = historyStack.length - 1;
  urlInput.value = url;
}

goBtn.addEventListener("click", () => {
  const url = urlInput.value.trim();
  if (url) loadURL(url);
});

urlInput.addEventListener("keypress", (e) => {
  if (e.key === "Enter") {
    const url = urlInput.value.trim();
    if (url) loadURL(url);
  }
});

backBtn.addEventListener("click", () => {
  if (currentIndex > 0) {
    currentIndex--;
    const engine = engineSelect.value;
    iframe.src = `${backendURL}?url=${encodeURL(historyStack[currentIndex])}&engine=${engine}`;
    urlInput.value = historyStack[currentIndex];
  }
});

forwardBtn.addEventListener("click", () => {
  if (currentIndex < historyStack.length - 1) {
    currentIndex++;
    const engine = engineSelect.value;
    iframe.src = `${backendURL}?url=${encodeURL(historyStack[currentIndex])}&engine=${engine}`;
    urlInput.value = historyStack[currentIndex];
  }
});

reloadBtn.addEventListener("click", () => {
  if (currentIndex >= 0) {
    const engine = engineSelect.value;
    iframe.src = `${backendURL}?url=${encodeURL(historyStack[currentIndex])}&engine=${engine}`;
  }
});

homeBtn.addEventListener("click", () => loadURL(homePage));

fullscreenBtn.addEventListener("click", () => {
  isFullscreen = !isFullscreen;
  iframe.classList.toggle("fullscreen", isFullscreen);
});

document.addEventListener("keydown", (e) => {
  if (isFullscreen && e.key === "Escape") {
    isFullscreen = false;
    iframe.classList.remove("fullscreen");
  }
});

// Load home page initially
loadURL(homePage);
</script>